<div class="dashboard-container">
  <!-- En-tÃªte du Dashboard -->
  <div class="dashboard-header">
    <h2>Bienvenue, {{ user?.first_name || user?.username }}! ğŸ‘‹</h2>
    <p>GÃ©rez votre orientation acadÃ©mique et dÃ©couvrez votre potentiel</p>
  </div>

  <!-- Ã‰tat de chargement -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>Chargement de votre tableau de bord...</p>
  </div>

  <!-- Message d'erreur -->
  <div *ngIf="error" class="error-container">
    <p class="error-message">{{ error }}</p>
  </div>

  <!-- Contenu principal -->
  <div *ngIf="!loading && !error">
    <!-- Sections principales -->
    <div class="dashboard-sections">
      
      <!-- Section: Test d'Orientation -->
      <div class="section-card">
        <h3>Test d'Orientation</h3>
        
        <!-- Test en cours -->
        <div *ngIf="activeTest" class="test-info in-progress">
          â³ Test en cours - CommencÃ© le {{ activeTest.started_at | date:'dd/MM/yyyy Ã  HH:mm' }}
        </div>
        
        <!-- Dernier test complÃ©tÃ© -->
        <div *ngIf="!activeTest && latestTest && latestTest.is_completed" class="test-info">
          âœ… Dernier test complÃ©tÃ© le {{ latestTest.completed_at | date:'dd/MM/yyyy' }}
        </div>
        
        <!-- Messages informatifs -->
        <p *ngIf="!activeTest && !latestTest">
          DÃ©couvrez les filiÃ¨res qui correspondent le mieux Ã  votre profil en passant notre test d'orientation.
        </p>
        
        <p *ngIf="activeTest">
          Vous avez un test en cours. Continuez lÃ  oÃ¹ vous vous Ãªtes arrÃªtÃ© ou commencez un nouveau test.
        </p>
        
        <p *ngIf="!activeTest && latestTest">
          Refaites le test pour affiner vos rÃ©sultats ou consultez vos rÃ©sultats prÃ©cÃ©dents.
        </p>
        
        <!-- Boutons d'action pour test en cours -->
        <div *ngIf="activeTest">
          <button class="btn btn-warning" (click)="continueTest()">
            â–¶ï¸ Continuer le test
          </button>
        </div>
        
        <!-- Boutons d'action sans test en cours -->
        <div *ngIf="!activeTest">
          <button class="btn" (click)="startNewTest()">
            {{ latestTest ? 'ğŸ”„ Nouveau test' : 'ğŸš€ Commencer le test' }}
          </button>
          
          <button 
            *ngIf="latestTest && latestTest.is_completed" 
            class="btn btn-secondary" 
            (click)="viewLatestResult()">
            ğŸ“Š Voir mes rÃ©sultats
          </button>
        </div>
      </div>

      <!-- Section: Mon Profil -->
      <div class="section-card">
        <h3>Mon Profil</h3>
        <p>Consultez et mettez Ã  jour vos informations personnelles, vos prÃ©fÃ©rences et vos objectifs acadÃ©miques.</p>
        <a routerLink="/student/profile" class="btn">
          âœï¸ GÃ©rer mon profil
        </a>
      </div>

      <!-- Section: Mes Favoris -->
      <div class="section-card">
        <h3>Mes FiliÃ¨res Favorites</h3>
        <p>Retrouvez toutes les filiÃ¨res que vous avez sauvegardÃ©es et comparez-les facilement.</p>
        <a routerLink="/student/favorites" class="btn">
          ğŸ’« Mes favoris
        </a>
      </div>
      
    </div>

    <!-- Section: Historique des Tests ComplÃ©tÃ©s -->
    <div class="history-section">
      <h3>Historique de mes Tests ComplÃ©tÃ©s</h3>
      
      <ul *ngIf="completedTests.length > 0" class="test-list">
        <li *ngFor="let test of completedTests">
          <span>
            ğŸ“… Test du {{ test.started_at | date:'dd/MM/yyyy Ã  HH:mm' }}
            <span *ngIf="test.completed_at"> - ComplÃ©tÃ© le {{ test.completed_at | date:'dd/MM/yyyy' }}</span>
          </span>
          <a [routerLink]="['/student/test-result', test.id]">
            Voir les rÃ©sultats â†’
          </a>
        </li>
      </ul>
      
      <div *ngIf="completedTests.length === 0" class="empty-state">
        <p>Aucun test complÃ©tÃ© pour le moment.</p>
        <p *ngIf="activeTest">Terminez votre test en cours pour voir vos rÃ©sultats ici!</p>
        <p *ngIf="!activeTest">Passez votre premier test pour voir vos rÃ©sultats ici!</p>
      </div>
    </div>
    
  </div>
</div>